- config:
    name: 标的录入通用参数
    variables:
        - url: http://10.65.209.29:8181/mas/gateway.do
        - service: create_bid_info
        - version: 1.0
        - request_time: ${get_now_time()}
        - partner_id: 200006658095
        - _input_charset: UTF-8
        - sign_type: RSA
        - sign_version: 1.0
        - encrypt_version: 1.0
        - notify_url: http://10.65.110.27:8888/receiveNotify
        - return_url: http://10.65.110.27:8888/receiveNotify
        - connect_db: ${connect_db(whpay)}
        - bid_tag: HBBOS
        - summary: 标的录入测试
    request:
        data:
            version: $version
            service: $service
            request_time: $request_time
            partner_id: $partner_id
            _input_charset: $_input_charset
            sign_type: $sign_type
            sign_version: $sign_version
            encrypt_version: $encrypt_version
            notify_url: $notify_url
            return_url: $return_url
            summary: $summary

- test:
    name: 个人会员标的录入正常
    variables:
        - borrower: 19941103
        - bid_name: ${get_now_time()}
        - out_bid_no: ${get_now_time()}
        - bid_type: BORROW
        - web_site_name: ${get_name()}
        - bid_amount: 100
        - borrower_info_list: $borrower~UID~$bid_amount~买房~18717937602~~~~~本科~未婚~上海~donghua@sina.com~~
        - bid_year_rate: 1
        - bid_duration: 22
        - repay_type: AVERAGE_CAPITAL
        - protocol_type: ASSIGNMENT_DEBT
        - begin_date: ${get_now_time()}
        - term: 20181001000000
        - guarantee_method: ${get_name()}
        - int_pay_type: MONTH_FIXED_DAY
        - int_pay_day: 21
        - tb_bid_info: select * from p2p.TB_BID_INFO p where p.source_bid_no ='$out_bid_no'

    request:
        method: POST
        url: $url
        data:
            bid_amount: $bid_amount
            web_site_name: $web_site_name
            bid_type: $bid_type
            bid_duration: $bid_duration
            protocol_type: $protocol_type
            url: $url
            begin_date: $begin_date
            term: $term
            guarantee_method: $guarantee_method
            repay_type: $repay_type
            borrower: $borrower
            borrower_info_list: $borrower_info_list
            out_bid_no: $out_bid_no
            bid_name : $bid_name
            int_pay_type: $int_pay_type
            int_pay_day: $int_pay_day
            bid_year_rate: $bid_year_rate

    extractors:
        - a_inner_bid_no: inner_bid_no

        - c_partner_id: ${get_db_field(p2puser, $tb_bid_info, partner_id)}
        - c_bid_amount: ${get_db_field(p2puser, $tb_bid_info, bid_amount)}
        - c_website_name: ${get_db_field(p2puser, $tb_bid_info, website_name)}
        - c_bid_name: ${get_db_field(p2puser, $tb_bid_info, bid_name)}
        - c_bid_tag: ${get_db_field(p2puser, $tb_bid_info, bid_tag)}
    validators:
        - {"check": "response_message", "comparator": "eq", "expected": "提交成功"}
        - {"check": "response_code", "comparator": "eq", "expected": "APPLY_SUCCESS"}

        - {"check": "partner_id", "comparator": "eq", "expected": "c_partner_id"}
        - {"check": "bid_amount", "comparator": "eq", "expected": "c_bid_amount"}
        - {"check": "web_site_name", "comparator": "eq", "expected": "c_website_name"}
        - {"check": "bid_tag", "comparator": "eq", "expected": "c_bid_tag"}


